/*
 * Wallaby.js - v1.0.1163
 * https://wallabyjs.com
 * Copyright (c) 2014-2021 Wallaby.js - All Rights Reserved.
 *
 * This source code file is a part of Wallaby.js and is a proprietary (closed source) software.

 * IMPORTANT:
 * Wallaby.js is a tool made by software developers for software developers with passion and love for what we do.
 * Pirating the tool is not only illegal and just morally wrong,
 * it is also unfair to other fellow programmers who are using it legally,
 * and very harmful for the tool and its future.
 */
function getAbsoluteImportRoot(){var e=require("module"),t=new e(".",null),i=path.dirname(global.wallaby._localNodeModules);t.filename=path.join(i,"wallaby.js"),t.paths=e._nodeModulePaths(i);var n=e._resolveFilename("ava",t,!1);if(n.endsWith(path.sep+"ava"+path.sep+"entrypoints"+path.sep+"main.mjs")||n.endsWith(path.sep+"ava"+path.sep+"entrypoints"+path.sep+"main.cjs"))return n.substring(0,n.length-(path.sep+"ava"+path.sep+"entrypoints"+path.sep+"main.mjs").length)}function avaRequire(e){return absoluteImportRoot&&(e=path.join(absoluteImportRoot,e)+".js"),{path:e,module:require(e)}}var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,s&&(o=2&i[0]?s["return"]:i[0]?s["throw"]||((o=s["return"])&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Q=require("q"),path=require("path"),tracer=global.$_$tracer,tracerUtils=tracer._utils,Runner,Test,runner,avaInstalled=!1,errorFormatter,format,improperUsage,onBeforeTest,onAfterTest,vm=require("vm"),url=require("url"),runtimeSupportsVmModules="function"==typeof vm.SyntheticModule;tracerUtils.patchModulesCode([{files:["ava/lib/snapshot-manager.js"],replacements:[{from:"function resolveSourceFile(file) {",to:"function resolveSourceFile(file) {\n          if (global.$_$testFiles) {\n            const metadata = global.$_$testFiles.find(m => m.path === file);\n            if (metadata && metadata.type && metadata.originalType && metadata.type !== metadata.originalType) {\t\t\t\n              return file.substring(0, file.length - metadata.type.length) + metadata.originalType;\n            }\n          }\n        "},{from:"const resolveSourceFile = mem(file => {",to:"const resolveSourceFile = mem(file => {\n          if (global.$_$testFiles) {\n            const metadata = global.$_$testFiles.find(m => m.path === file);\n            if (metadata && metadata.type && metadata.originalType && metadata.type !== metadata.originalType) {\t\t\t\n              return file.substring(0, file.length - metadata.type.length) + metadata.originalType;\n            }\n          }\n        "}]}]);try{var absoluteImportRoot=getAbsoluteImportRoot()}catch(e){}try{var nodeFs=require("fs"),originalRenameSync=nodeFs.renameSync;originalRenameSync.alreadyReplaced||(nodeFs.renameSync=function(e,t){var i=originalRenameSync.apply(this,arguments);if((".snap"===path.extname(t)||".md"===path.extname(t))&&0===t.indexOf(global.wallaby.projectCacheDir)){var n=require("fs-extra"),r=path.join(global.wallaby.localProjectDir,path.relative(global.wallaby.projectCacheDir,t));r&&(n.ensureDirSync(path.dirname(r)),nodeFs.writeFileSync(r,nodeFs.readFileSync(t)))}return i},nodeFs.renameSync.alreadyReplaced=!0);var Module=require("module").Module,modulePrototype=Module.prototype,originalRequire=modulePrototype.require;modulePrototype.require=function(e){if("ava"===e){var t=runner.test||runner.chain.test||runner.chain;return t["default"]=t,t.test=t,t}if("empower-core"===e){var i=originalRequire.call(this,e),n=function(){var e=arguments[1].onError;return arguments[1].onError=function(t){return t.originalMessage=t.error.message+"\n",e.apply(this,arguments)},i.apply(this,arguments)};return n.defaultOptions=i.defaultOptions,n}return originalRequire.call(this,e)};var changeTestMetadata=function(e){e.metadata.serial=!0,e.metadata._ignored="test"===e.metadata.type&&tracer.hasSpecFilter()&&!tracer.specFilter([e.title]),e.metadata._testFile=tracer.entryFile(),e.metadata._ignored&&(e.metadata.skipped=!0)};try{avaRequire("ava/lib/worker/options").set({}).module}catch(e){}try{var createChainReq=avaRequire("ava/lib/worker/create-chain-req"),originalCreateChain=createChainReq.module;require.cache[require.resolve(createChainReq.path)].exports=function(){var e=arguments[0];return arguments[0]=function(t,i){return changeTestMetadata({metadata:t,title:"string"==typeof i[0]?i[0]:void 0}),e.apply(this,arguments)},originalCreateChain.apply(this,arguments)}}catch(e){}try{avaRequire("ava/lib/chalk").module.set({enabled:!1}).module}catch(e){}try{improperUsage=avaRequire("ava/lib/reporters/improper-usage-messages").module}catch(e){}var originalObjectDefineProperty=Object.defineProperty;Object.defineProperty=function(e,t,i){return"AssertionError"===t&&(i.writable=!0),originalObjectDefineProperty.apply(this,arguments)},avaRequire("ava/lib/assert").module,Runner=avaRequire("ava/lib/runner").module,Object.defineProperty=originalObjectDefineProperty;try{errorFormatter=avaRequire("ava/lib/enhance-assert").module.formatter;try{errorFormatter()&&(errorFormatter=errorFormatter())}catch(e){}}catch(e){errorFormatter=null}Test=avaRequire("ava/lib/test").module;var originalTestRun=Test.prototype.run;Test.prototype.run=function(){onBeforeTest(this);try{tracer.specSyncStart();var e=originalTestRun.apply(this,arguments);return e.then&&e.then(function(e){return onAfterTest(e),e}),e}finally{tracer.specSyncEnd()}},avaInstalled=!0}catch(e){tracer.start(function(){tracer.reportGlobalError("ava node module is not found or the version is not supported, missing `npm install ava --save-dev`?\n"+(e.stack||""))}),module.exports={init:function(){return{configure:function(){}}}}}if(avaInstalled){var testFiles=[],options={},util=require("util"),truncate=function(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e},getMessage=function(e){return truncate(util.inspect(e.actual),128)+" "+e.operator+" "+truncate(util.inspect(e.expected),128)};tracer.start(function(){var sessionId=global.$_$session,runComplete=!1,otherSession=function(){return sessionId!==global.$_$session},completeRun=function(){runComplete||otherSession()||(runComplete=!0,tracer.complete())},isHook=function(e){return"test"!==e.metadata.type},specId=tracer.initialSpecId();tracer.started({total:"unknown number of"});var runnerPromise=Q.when(!0);testFiles.forEach(function(file){runnerPromise=runnerPromise.then(function(){return __awaiter(this,void 0,void 0,function(){var fileUrl,isExclusiveTestRun,ignoredTasks,_a,_b,task,_c,_d,task,ignoredTasks_1,ignoredTasks_1_1,task,onFulfilled,e_1,e_2,_e,e_3,_f,e_4,_g;return __generator(this,function(_h){switch(_h.label){case 0:try{avaRequire("ava/lib/globals").module.options={file:file},delete avaRequire("ava/lib/snapshot-state").module.state}catch(e){}runner=new Runner(__assign(__assign({},options),{file:file,projectDir:global.wallaby.projectCacheDir,recordNewSnapshots:!0,updateSnapshots:tracer.canUpdateSnapshots()})),tracer.avaRunner=runner,onBeforeTest=function(e){otherSession()||isHook(e)||(e.metadata._id=++specId,tracer.specStart(e.metadata._id,e.title))},onAfterTest=function(e){if(!otherSession()){var t=e.passed;e=e.result?e.result:e;var i=isHook(e);if(!t||!i){var n=e.metadata.skipped||e.metadata.todo,r=tracer.specEnd(),s=e.metadata.skipped?"skipped":e.metadata.todo?"todo":"executed",o={id:e.metadata._id,timeRange:r,name:e.title,suite:[],status:s,time:void 0===e.duration?0:e.duration,log:[],hook:i?e.metadata.type:void 0,testFile:e.metadata&&e.metadata._testFile||void 0};if(!t&&!n){var a=e.assertError||e.error;if("Error thrown in test"===a.message&&delete a.message,a.powerAssertContext&&errorFormatter&&(a.message=errorFormatter(a.powerAssertContext)),improperUsage){var l=improperUsage.forError(a);l&&(a.message=(a.message||"")+"\n"+l)}a.showDiff=!0;var c={message:a.message,stack:a.stack};/^\s+$/.test(c.message)?c.message=getMessage(a):!c.message&&format?c.message=format.formatSerializedError(a):a.values&&a.values.length&&(c.message=(c.message?c.message+"\n":"")+a.values[0].formatted),a.raw&&(a.actual=a.raw.actual,a.expected=a.raw.expected),tracer.setAssertionData(a,c),o.log.push(c)}o.log.length||delete o.log,tracer.result(o)}}},_h.label=1;case 1:return _h.trys.push([1,5,,6]),runtimeSupportsVmModules?(fileUrl=url.pathToFileURL(file),fileUrl.href=fileUrl.href+"?update="+ +new Date+"&wallaby=true",[4,eval("import(fileUrl)")]):[3,3];case 2:return _h.sent(),[3,4];case 3:require(file),_h.label=4;case 4:if(isExclusiveTestRun=!1,ignoredTasks=[],runner.tasks.serial)try{for(_a=__values(runner.tasks.serial),_b=_a.next();!_b.done;_b=_a.next())task=_b.value,!isExclusiveTestRun&&(isExclusiveTestRun=task.metadata.exclusive)||task.metadata.skipped&&ignoredTasks.push(task)}catch(e_2_1){e_2={error:e_2_1}}finally{try{_b&&!_b.done&&(_e=_a["return"])&&_e.call(_a)}finally{if(e_2)throw e_2.error}}if(isExclusiveTestRun)ignoredTasks=[];else if(runner.tasks.todo)try{for(_c=__values(runner.tasks.todo),_d=_c.next();!_d.done;_d=_c.next())task=_d.value,ignoredTasks.push(task)}catch(e_3_1){e_3={error:e_3_1}}finally{try{_d&&!_d.done&&(_f=_c["return"])&&_f.call(_c)}finally{if(e_3)throw e_3.error}}try{for(ignoredTasks_1=__values(ignoredTasks),ignoredTasks_1_1=ignoredTasks_1.next();!ignoredTasks_1_1.done;ignoredTasks_1_1=ignoredTasks_1.next())task=ignoredTasks_1_1.value,task.metadata._ignored||(onBeforeTest(task),onAfterTest(task))}catch(e_4_1){e_4={error:e_4_1}}finally{try{ignoredTasks_1_1&&!ignoredTasks_1_1.done&&(_g=ignoredTasks_1["return"])&&_g.call(ignoredTasks_1)}finally{if(e_4)throw e_4.error}}return onFulfilled=function(){runner.saveSnapshotState&&runner.saveSnapshotState()},[2,Q.promise(function(e){runner.on("error",function(e){throw e}),runner.on("start",function(t){return e(t.ended.then(onFulfilled))}),runner.on("finish",function(){return onFulfilled(),e()}),runner.start(),runner.start=function(){}})];case 5:return e_1=_h.sent(),tracer.reportDeclarationError(e_1),[2,Q.when(!0)];case 6:return[2]}})})})}),runnerPromise.then(completeRun)}),module.exports={init:function(e){return testFiles=e,options}}}